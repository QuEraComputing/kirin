---
source: crates/kirin-chumsky-format/src/generate/tests.rs
expression: emit
---
impl<'tokens, 'src: 'tokens, Language: ::kirin_ir::Dialect> ::kirin_chumsky::EmitIR<Language>
    for MixedLangAST<'tokens, 'src, Language>
where
    Language: ::kirin_ir::Dialect + From<MixedLang>,
    <SimpleType as ::kirin_chumsky::HasParser<'tokens, 'src>>::Output:
        ::kirin_chumsky::EmitIR<Language, Output = <Language as ::kirin_ir::Dialect>::TypeLattice>,
{
    type Output = ::kirin_ir::Statement;
    fn emit(&self, ctx: &mut ::kirin_chumsky::EmitContext<'_, Language>) -> Self::Output {
        match self {
            MixedLangAST::Arith(inner) => inner.emit(ctx),
            MixedLangAST::Custom {
                arg: f_arg,
                res: f_res,
            } => {
                let f_arg_ir: ::kirin_ir::SSAValue = ::kirin_chumsky::EmitIR::emit(f_arg, ctx);
                let f_res_ir: ::kirin_ir::ResultValue = ::kirin_chumsky::EmitIR::emit(f_res, ctx);
                let dialect_variant: MixedLang = MixedLang::Custom {
                    arg: f_arg_ir.into(),
                    res: f_res_ir.into(),
                };
                ctx.context.statement().definition(dialect_variant).new()
            }
            MixedLangAST::Control(inner) => inner.emit(ctx),
            MixedLangAST::__Marker(_, unreachable) => match *unreachable {},
        }
    }
}
